(()=>{"use strict";class t{constructor(t){this.todos=document.querySelector(".todos"),this.app=t}pushTodos(t){t.forEach((t=>{const e=document.createElement("div");e.setAttribute("id",`todo${t.id}`);const o=document.createElement("p");o.textContent=t.title;const s=document.createElement("p");s.textContent=t.date;const d=document.createElement("button");t.completed&&(o.classList.add("done-todo"),s.classList.add("done-todo"),d.setAttribute("disabled",!0)),d.textContent="Done",this.addSaveEvent(d,t.id);const n=document.createElement("button");this.addDeleteEvent(n,t.id),n.textContent="Delete",[{name:e,arrClasses:["td-item"]},{name:o,arrClasses:["td-item-title"]},{name:s,arrClasses:["td-item-date"]},{name:d,arrClasses:["td-item-buttonSave","td-item-button"]},{name:n,arrClasses:["td-item-buttonDelete","td-item-button"]}].forEach((t=>{this._setTodosClasses(t.name,t.arrClasses)})),e.appendChild(o),e.appendChild(s),e.appendChild(d),e.appendChild(n),this.todos.appendChild(e)}))}_setTodosClasses(t,e){for(let o of e)t.classList.add(o)}resetInputsTitleDate(){const t=document.querySelector(".title"),e=document.querySelector(".date");t.value="",e.value=""}addSaveEvent(t,e){t.addEventListener("click",(()=>{this.app.saveSingleTodo(e)}))}addDeleteEvent(t,e){t.addEventListener("click",(()=>{this.app.deleteSingleTodo(e)}))}removeElementById(t){document.querySelector(`#${t}`).remove()}renderElementById(t){document.querySelector(`#${t}`).classList.add("done-todo"),document.querySelector(`#${t} > .td-item-buttonSave`).setAttribute("disabled",!0)}}class e{constructor(){this.url="http://localhost:4000/api/todos/"}getTodos(){return fetch(this.url)}postTodo(t){return fetch(this.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}putTodo(t){return fetch(this.url,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}deleteTodo(t){return fetch(this.url,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}}const o=new class{constructor(){this.todos=[],this.render=new t(this),this.request=new e}loadTodos(){this.request.getTodos().then((t=>t.json())).then((({data:t})=>{this.todos=t,this.renderTodos(this.todos),console.log(this.todos)}))}renderTodos(){this.render.pushTodos(this.todos)}addTodo(t){t.id=this.todos.length+1,this.request.postTodo(t).then((t=>t.json())).then((({data:t})=>{this.todos.push(t);const e=[];e.push(t),this.render.pushTodos(e),console.log(this.todos),this.render.resetInputsTitleDate()}))}saveSingleTodo(t){this.id=t;const e={id:this.id,completed:!0};this.request.putTodo(e).then((t=>t.json())).then((({data:t})=>{t&&(this.render.renderElementById(`todo${this.id}`),this.request.getTodos().then((t=>t.json())).then((({data:t})=>{this.todos=t,console.log(this.todos)})))}))}deleteSingleTodo(t){this.id=t;const e={id:this.id};this.request.deleteTodo(e).then((t=>t.json())).then((({data:t})=>{!0===t&&(this.render.removeElementById(`todo${this.id}`),this.request.getTodos().then((t=>t.json())).then((({data:t})=>{this.todos=t,console.log(this.todos)})))}))}},s=new class{constructor(t){this.buttonCreate=document.querySelector(".btnCreate"),this.inputTitle=document.querySelector(".title"),this.inputDate=document.querySelector(".date"),this.app=t}addListners(){this.buttonCreate.addEventListener("click",this.addTodo.bind(this))}addTodo(){const t={title:this.inputTitle.value,date:this.inputDate.value,completed:!1};this.app.addTodo(t)}}(o);o.loadTodos(),s.addListners()})();